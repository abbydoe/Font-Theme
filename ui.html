<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Font Plugin</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css"
    />

    <style>
      /* Reset Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .dark {
        background-color: #1a1a1a;
        color: #ffffff;
      }
      body,
      html {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        font-size: 14px;
        color: #333;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        background-color: #ffffff;
        color: #000000;
      }
      body.dark-mode {
        background-color: #1a1a1a;
        color: #ffffff;
      }

      #sidebar.dark {
        background-color: #1a1a1a;
        color: #ffffff;
      }

      #container {
        display: flex;
        height: 100%;
        width: 100%;
      }

      #sidebar {
        width: 200px; /* Reduce width to avoid pushing content */
        background-color: #f4f4f4;
        padding: 20px;
        overflow-y: auto;
        box-sizing: border-box; /* Include padding in the width calculation */
      }

      #sidebar h2 {
        font-size: 16px;
        margin-bottom: 10px;
      }

      #sidebar p {
        font-size: 12px;
        line-height: 1.5;
      }

      #sidebar hr {
        margin: 10px 0;
        border: none;
        border-top: 1px solid #ccc;
      }

      .tabs {
        display: flex;
        border-bottom: 1px solid #ddd;
       
      }

      .tab {
        flex: 1;
        text-align: center;
        padding: 10px;
        background-color: #f9f9f9;
        border: none;
        outline: none;
        cursor: pointer;
        font-size: 14px;
        color: #666; /* Inactive tab color */
      }

      .tab.active {
        background-color: #fff;
        border-bottom: 2px solid black;
        color: black; /* Active tab color */
        font-weight: bold;
      }

      .content {
        display: block;
        padding-top: 20px;
        overflow-y: auto;
        flex: 1;
      }

      .content.active {
        display: block;
      }

      .content h1 {
        font-size: 18px;
        margin-bottom: 10px;
      }

      .content p {
        font-size: 14px;
        margin-bottom: 10px;
      }

      .font-preview {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .font-column {
        width: 48%;
      }

      .font-column h3 {
        font-size: 16px;
        margin-bottom: 10px;
      }

      .font-weight {
        font-size: 12px;
        font-weight: bold;
        margin: 5px 0;
      }

      .font-sample {
        font-size: 14px;
        margin: 5px 0 10px;
      }

      .button-container {
        display: flex;
        justify-content: space-between;
        padding-top: 20px;
      }

      .find-font-button button {
        width: 100%; /* Make the button take the full width of its parent container */
      }

      .dark .switch__label {
        color: #ffffff;
      }

     

      button {
        padding: 10px;
        border: none;
        background-color: black;
        color: white;
        font-size: 14px;
        cursor: pointer;
        flex: 1;
        margin: 0 10px;
      }

      button:hover {
        background-color: #333;
      }

      /* Prevent horizontal scrolling for the entire content */
      #find-font {
        overflow-x: hidden; /* Disable horizontal scrolling */
        width: 100%; /* Ensure it takes up the full width of its container */
        box-sizing: border-box; /* Include padding and borders in width calculation */
      }

      /* Ensure the textarea fits within the parent */
      #font-feeling {
        width: 100%; /* Responsive to parent container */
        max-width: 100%; /* Prevent overflow beyond parent */
        height: 50px;
        padding: 10px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 20px;
        resize: none; /* Disable manual resizing */
        box-sizing: border-box; /* Include padding and borders in width */
      }

      /* Radio button container */
      .font-pair-options {
        display: flex;
        flex-direction: column;
        gap: 10px; /* Vertical spacing between radio options */
        margin-bottom: 20px;
        width: 100%; /* Ensure no horizontal overflow */
        border-bottom: #666;
      }

      /* Ensure each radio button label fits neatly */
      .font-pair-options label {
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px; /* Space between radio button and label text */
        word-wrap: break-word; /* Ensure text wraps if it overflows */
      }

      body.dark button {
        background-color: #ffffff;
        color: #000000;
        border: 1px solid #ffffff;
      }

      #find-font-button:hover {
        background-color: #333; /* Darker background on hover */
      }
      p[contenteditable]:focus {
        outline: none; /* Remove default focus outline */
        border: 1px solid #ccc; /* Add a light border */
        border-radius: 4px; /* Optional: Rounded corners */
        padding: 5px; /* Optional: Inner padding for better spacing */
        background-color: #f9f9f9; /* Optional: Subtle background color */
      }

      /* General content wrapper styles to prevent overflow */
      .content {
        width: 100%; /* Ensure content spans the container */
        max-width: 100%; /* Prevent horizontal overflow */
        box-sizing: border-box; /* Include padding and borders in width */
        padding: 10px; /* Optional padding */
      }
      /* General styles for the font categories */
      .font-row {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap; /* Wrap font cards if necessary */
        gap: 10px; /* Add spacing between font cards */
        margin: 20px 0;
      }

      .font-card {
        flex: 1;
        min-width: 150px; /* Minimum size for small screens */
        max-width: 30%; /* Limit width to avoid overflowing */
        padding: 10px;
        text-align: center;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .font-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .font-card h3 {
        font-size: 16px;
        margin-bottom: 10px;
      }

      .font-card p {
        font-size: 14px;
        /* Remove the outlined box around the body text */
        margin: 5px 0;
        border: none; /* Ensure no border is applied */
        padding: 0; /* Remove any padding */
        background: none; /* Remove background color, if any */
        box-shadow: none; /* Remove any shadow effects */
      }

      /* Ensure the buttons container fits within the parent */
      .button-container {
        display: flex;
        justify-content: space-between; /* Spread buttons evenly */
        margin-top: 20px;
        width: 100%; /* Ensure it spans the full width of the parent */
        padding: 0; /* Remove extra padding */
        gap: 10px; /* Add spacing between buttons */
        box-sizing: border-box; /* Include padding and borders in width calculations */
        overflow-x: hidden; /* Prevent horizontal scrolling */
      }

      /* Ensure buttons fit within the container */
      .button-container button {
        flex: 1; /* Distribute buttons evenly */
        padding: 10px;
        border: none;
        background-color: black;
        color: white;
        font-size: 14px;
        border-radius: 30px;
        cursor: pointer;
        box-sizing: border-box; /* Include padding and borders in width */
      }

      /* Prevent horizontal overflow on the main content area */
      #main {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 20px;
        width: 100%; /* Ensure it spans the full width */
        box-sizing: border-box; /* Include padding in width calculations */
        overflow-x: hidden; /* Eliminate horizontal scrolling */
      }



      .options {
        display: flex;
        align-items: start;
        flex-wrap: wrap;
        gap: 16px;
        list-style-type: none;
        margin: 20px 0;
      }

      .options li {
        flex: 1;
        display:inline-block;
      }
      .option-content {
    display: none; /* Hide all content by default */
}

.option-content.active {
    display: block; /* Show only active content */
}

.find-font-content {
  display: block;
}



      button.option {
        background-color: transparent;
        color: #666;
        border-bottom: 2px solid #ccc;
        margin-left: 8px;
        margin-right: 24px;
        padding-left: 0%;
    
      }
      button.option-active {
        background-color: transparent;
        color: #666;
        border-bottom: 2px solid #ccc;
        margin-left: 8px;
        margin-right: 24px;
        padding-left: 0%;
        font-weight: bold;
    
      }
      .content {
  display: none; /* Hide all content by default */
  padding: 20px;
  background-color: #ffffff;
}


.content.active {
  display: block; /* Show only active content */
}

      /* Button hover effect */
      .button-container button:hover {
        background-color: #333;
      }
      fieldset {
        border: none;
        padding: 0;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <!-- Sidebar -->
      <div id="sidebar">
        <h2>Saved Fonts</h2>
        <p>Saved fonts and font pairs will appear in this sidebar.</p>
        <hr />
        <p>
          Click on a saved font to view the font family and add the font
          directly to your Figma file.
        </p>
        <div id="saved-fonts">

        </div>
        <!-- Switch -->
        <div class="switch">
          <input class="switch__toggle" type="checkbox" id="dark-mode-on" />
          <label class="switch__label" for="dark-mode-on">Dark Mode</label>
        </div>
      </div>

      <!-- Main Content -->
      <div id="main">
        <!-- Tabs -->
        <div class="tabs">
          <button class="tab active" id="find-font-tab">Search Font Theme</button>
          <button class="tab" data-tab="tab2" id="font-family-tab">
            Results
          </button>
          <button class="tab" id="all-font-categories-tab">
            All Font Themes
          </button>
        </div>

        <!-- Find Font Content -->
        <div class="content active" id="find-font" style="display: block">
          <h2>What feeling does your font need to have?</h2>
          <textarea
            id="font-feeling"
            type="vibe"
            placeholder="Example: Professional, but friendly and approachable."
          ></textarea>

          <fieldset class="font-pair-options">
            <legend>How many fonts do you want to pair?</legend>
            <label>
              <input type="radio" id="pairing1" name="fontPairing" value="1" />
              1
            </label>
            <label>
              <input type="radio" id="pairing2" name="fontPairing" value="2" />
              2
            </label>
            <label>
              <input type="radio" id="pairing3" name="fontPairing" value="3" />
              3
            </label>
          </fieldset>

          <div class="button-container find-font-button">
            <button id="find-font-btn">Find Font</button>
          </div>
        </div>

        <!-- Results tab content -->
        <div class="content" id="font-family" >
          <div>
            <ul class="options" style="display: block">
              <li> <button id ="option1" class="option active" data-target="option1-content">Option 1</button> </li>
              <li><button id="option2" class="option" data-target="option2-content">Option 2</button></li> 
              <li><button id="option3" class="option" data-target="option3-content">Option 3</button> </li>
              <li>
                <button id="option4" class="option" data-target="option4-content">Option 4</button>
              </li>
              <li>
                <button id="option5" class="option" data-target="option5-content">Option 5</button>
              </li>
            </ul>
            <div id="option1-content" class="option-content active" >
            </div>
            <div id="option2-content" class="option-content">
            </div>
            <div id="option3-content" class="option-content">
            </div>
            <div id="option4-content" class="option-content">
            </div>
            <div id="option5-content" class="option-content">
            </div>
          </div>
      </div>
       <!-- All Font Themes Content -->
       <div class="content" id="all-font-categories" >
        <h2>Professional, Approachable, Fun</h2>
        <div class="font-row">
          <div class="font-card" data-font="Lato">
            <h3>Lato</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Open Sans">
            <h3>Open Sans</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Poppins">
            <h3>Poppins</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>

        <h2>Modern, Sleek, Minimal</h2>
        <div class="font-row">
          <div class="font-card" data-font="Montserrat">
            <h3>Montserrat</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Helvetica Neue">
            <h3>Helvetica Neue</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Futura">
            <h3>Futura</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>

        <h2>Elegant, Luxury, High-end</h2>
        <div class="font-row">
          <div class="font-card" data-font="Baskerville">
            <h3>Baskerville</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Playfair Display">
            <h3>Playfair Display</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Cormorant">
            <h3>Cormorant</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>
        <h2>Elegant, Luxury, High-end</h2>
        <div class="font-row">
          <div class="font-card" data-font="Baskerville">
            <h3>Baskerville</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Playfair Display">
            <h3>Playfair Display</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Cormorant">
            <h3>Cormorant</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>
        <h2>Elegant, Luxury, High-end</h2>
        <div class="font-row">
          <div class="font-card" data-font="Baskerville">
            <h3>Baskerville</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Playfair Display">
            <h3>Playfair Display</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Cormorant">
            <h3>Cormorant</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>
        <h2>Elegant, Luxury, High-end</h2>
        <div class="font-row">
          <div class="font-card" data-font="Baskerville">
            <h3>Baskerville</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Playfair Display">
            <h3>Playfair Display</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Cormorant">
            <h3>Cormorant</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>
        <h2>Elegant, Luxury, High-end</h2>
        <div class="font-row">
          <div class="font-card" data-font="Baskerville">
            <h3>Baskerville</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Playfair Display">
            <h3>Playfair Display</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
          <div class="font-card" data-font="Cormorant">
            <h3>Cormorant</h3>
            <p>AaBbDdEeGgMmOoRrSs<br />1234567890!?@#$%</p>
          </div>
        </div>

        <!-- Buttons (Initially Hidden) -->
        <div
          class="button-container"
          id="action-buttons"
          style="display: none"
        >
          <button id="use-font">Use Font</button>
          <button id="save-font">Save for Later</button>
        </div>
      </div>
    </div>
    <script>
      
  document.addEventListener("DOMContentLoaded", function () {
    const tabs = document.querySelectorAll(".tab");
    const contents = document.querySelectorAll(".content");

    // Add event listeners for tab clicks - when user switches tabs.
    tabs.forEach((tab) => {
        tab.addEventListener("click", function () {
            // Remove 'active' class from all tabs and hide all content sections
            tabs.forEach((t) => t.classList.remove("active"));
            // contents.forEach((content) => (content.style.display = "none"));

            // Add 'active' class to the clicked tab
            this.classList.add("active");

            // Get the content ID from data-tab OR manually map tab ID to content
            contents.forEach((content) => (content.style.display = "none"));
            const contentId = this.id.replace("-tab", "");
            const targetContent = document.getElementById(contentId);

            if (targetContent) {
                targetContent.style.display = "block";
            } else {
                console.warn(`No content found for tab: ${this.id}`);
            }
        });
    });
  });

  // Javascript for option content in results tabs
  const optionButtons = document.querySelectorAll(".option");
  const optionContents = document.querySelectorAll(".option-content");

  optionButtons.forEach((button) => {
    button.addEventListener("click", function () {
      // Remove 'active' class from all buttons
      optionButtons.forEach((btn) => btn.classList.remove("active"));

      // Add 'active' class to the clicked button
      this.classList.add("active");

      // Hide all option content sections
      optionContents.forEach((content) => (content.style.display = "none"));

      // Show the corresponding option content section
      const targetId = this.getAttribute("data-target");
      const targetContent = document.getElementById(targetId);
      if (targetContent) {
        targetContent.style.display = "block";
      }
    });
  });

  //Toggle Switch
  const body = document.getElementById("dark-mode-on");
  const sidebar = document.getElementById("sidebar");
  body.addEventListener("click", function () {
    document.body.classList.toggle("dark");
    if (sidebar) sidebar.classList.toggle("dark");
  });

  // Find Font Button
  const findFontButton = document.getElementById("find-font-btn");

  findFontButton.addEventListener("click", () => {
          const vibe = document.getElementById("font-feeling").value.trim();
          const fontPairing = 2; // Hardcoded value

          // Validate input
          if (!vibe) {
            alert("Please enter a vibe before finding font pairings.");
            return;
          }
          parent.postMessage(
            { pluginMessage: { type: "find-font", vibe, fontPairing } },
            "*"
          );
        });

// Function to Save Font Pair to Sidebar
  function saveFontPair(optionNumber, fontPair) {
  let sidebar = document.getElementById("saved-fonts"); // Get the sidebar container
  if (!sidebar) return;

  // Create a container for the saved font pair
  let savedItem = document.createElement("div");
  savedItem.classList.add("saved-font-pair");

  // Add option number as heading
  let optionHeading = document.createElement("h3");
  optionHeading.textContent = `Option ${optionNumber}`;
  savedItem.appendChild(optionHeading);

  // Add font pair names
  let fontNames = document.createElement("p");
  fontNames.textContent = fontPair.font3
    ? `${fontPair.font1} & ${fontPair.font2} & ${fontPair.font3}`
    : `${fontPair.font1} & ${fontPair.font2}`;
  savedItem.appendChild(fontNames);

  // Append to sidebar
  sidebar.appendChild(savedItem);
}

  window.onmessage = (event) => {
      const message = event.data.pluginMessage;

      if (message.type === "font-pairings-response") {
        console.log("Font pairings received in ui html:", message.data);
        displayFontPairingsInOptions(message.data); // ✅ Update UI with the data
      }

      if (message.type === "error") {
        console.error("Error:", message.message);
        alert(message.message); // Show an error message in UI
      }
    };

  function displayFontPairingsInOptions(fontPairs) {
  console.log(fontPairs);
  const maxOptions = 5;

  for (let i = 0; i < maxOptions; i++) {
    let optionContent = document.getElementById(`option${i + 1}-content`);
    if (!optionContent) continue;

    let pair = fontPairs[i];
    console.log(`Updating option ${i + 1} with fonts:`, pair);

    // ⚡ Clear previous content but keep buttons
    let existingButtons = optionContent.querySelector(".button-container");
    optionContent.innerHTML = ""; // Remove all previous content
    if (existingButtons) optionContent.appendChild(existingButtons); // Re-add buttons

    // ✅ Rebuild missing elements dynamically

    // Heading
    let heading = document.createElement("h1");
    heading.textContent = `Option ${i + 1} content`;
    optionContent.appendChild(heading);

    // Date
    let date = document.createElement("p");
    date.classList.add("date");
    date.textContent = new Date().toDateString(); // Use today's date
    optionContent.appendChild(date);

    // Editable paragraph
    let editableParagraph = document.createElement("p");
    editableParagraph.setAttribute("contenteditable", "true");
    editableParagraph.textContent =
      "This paragraph is how these fonts look when paired together. You can edit this text.";
    optionContent.appendChild(editableParagraph);

    // Font preview container
    let fontPreview = document.createElement("div");
    fontPreview.classList.add("font-preview");

    // ✅ Function to create font preview columns
    function createFontColumn(fontName, weights) {
      let column = document.createElement("div");
      column.classList.add("font-column");

      let fontTitle = document.createElement("h3");
      fontTitle.textContent = fontName;
      fontTitle.style.fontFamily = fontName;
      column.appendChild(fontTitle);

      weights.forEach((weight) => {
        let weightLabel = document.createElement("p");
        weightLabel.classList.add("font-weight");
        weightLabel.textContent = getWeightName(weight);

        let weightSample = document.createElement("p");
        weightSample.classList.add("font-sample");
        weightSample.textContent = "AaBbDdEeGgMmOoRrSs\n1234567890!?@#$%";
        weightSample.style.fontFamily = fontName;
        weightSample.style.fontWeight = weight;

        column.appendChild(weightLabel);
        column.appendChild(weightSample);
      });

      return column;
    }

    // ✅ Append new font columns
    fontPreview.appendChild(createFontColumn(pair.font1, pair.weights1));
    fontPreview.appendChild(createFontColumn(pair.font2, pair.weights2));
    if (pair.font3) {
      fontPreview.appendChild(createFontColumn(pair.font3, pair.weights3));
    }

    optionContent.appendChild(fontPreview);

    // Ensure buttons are inside the content
    if (!existingButtons) {
      let buttonContainer = document.createElement("div");
      buttonContainer.classList.add("button-container");

      let useFontButton = document.createElement("button");
      useFontButton.id = "use-font";
      useFontButton.textContent = "Create Text Style";

      let saveFontButton = document.createElement("button");
      saveFontButton.id = "save-font";
      saveFontButton.textContent = "Save for Later";

      buttonContainer.appendChild(useFontButton);
      buttonContainer.appendChild(saveFontButton);
      optionContent.appendChild(buttonContainer);
    }
  }

  // ✅ Switch to Results tab automatically
  switchToResultsTab();
}

// ✅ Function to convert font weight numbers to readable names
function getWeightName(weight) {
  const weightMap = {
    100: "Thin",
    200: "Extra Light",
    300: "Light",
    400: "Regular",
    500: "Medium",
    600: "Semi Bold",
    700: "Bold",
    800: "Extra Bold",
    900: "Black",
  };
  return weightMap[weight] || `Weight ${weight}`;
}



  function switchToResultsTab() {
  let resultsTab = document.getElementById("font-family-tab"); // Adjust the ID if needed
  if (resultsTab) {
    resultsTab.click(); // Simulate a click event on the Results tab
    console.log("Switched to Results tab programmatically!");
  } else {
    console.warn("Results tab not found! Make sure the ID is correct.");
  }
}
    </script>
  </body>
</html>
